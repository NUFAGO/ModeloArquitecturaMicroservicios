// components/compras.components.c4 - Microservicio de Compras (KAPO PRINCIPAL - ESTRUCTURA REAL)

model {
  // ===== ðŸŸ¦ API GRAPHQL =====
  cp_graphql_api = application 'GraphQL API' {
    description 'API GraphQL principal del backend para mÃ³dulo de compras'
    technology 'Apollo Server + Express.js'

    style {
      color blue  // Azul para APIs
    }
  }

  // ===== ðŸŸ© SERVICIOS PRINCIPALES =====
  cp_compra_service = application 'CompraService' {
    description 'Servicio principal para gestiÃ³n de compras completas'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_cotizacion_service = application 'CotizacionService' {
    description 'Servicio para gestiÃ³n de cotizaciones con proveedores'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_orden_compra_service = application 'OrdenCompraService' {
    description 'Servicio principal para gestiÃ³n de Ã³rdenes de compra'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_proveedor_service = application 'ProveedorService' {
    description 'Servicio para homologaciÃ³n y gestiÃ³n de proveedores'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_procesador_compra_completa_service = application 'ProcesadorCompraCompletaService' {
    description 'Servicio para procesamiento completo del flujo de compras'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  // ===== ðŸŸ¨ RESOLVERS =====
  cp_compra_resolver = component 'CompraResolver' {
    technology 'GraphQL Resolver'
    description 'Resolver para operaciones CRUD de compras'

    style {
      color amber  // Amarillo para resolvers
    }
  }

  cp_cotizacion_resolver = component 'CotizacionResolver' {
    technology 'GraphQL Resolver'
    description 'Resolver para operaciones de cotizaciones'

    style {
      color amber  // Amarillo para resolvers
    }
  }

  cp_orden_compra_resolver = component 'OrdenCompraResolver' {
    technology 'GraphQL Resolver'
    description 'Resolver para operaciones CRUD de Ã³rdenes de compra'

    style {
      color amber  // Amarillo para resolvers
    }
  }

  cp_proveedor_resolver = component 'ProveedorResolver' {
    technology 'GraphQL Resolver'
    description 'Resolver para operaciones de proveedores'

    style {
      color amber  // Amarillo para resolvers
    }
  }

  cp_solicitud_compra_resolver = component 'SolicitudCompraResolver' {
    technology 'GraphQL Resolver'
    description 'Resolver para operaciones de solicitudes de compra'

    style {
      color amber  // Amarillo para resolvers
    }
  }

  // ===== â¬œ MODELOS/ENTIDADES =====
  cp_compra_model = component 'Compra Model' {
    technology 'Mongoose Schema'
    description 'Modelo de datos para compras'

    style {
      color slate  // Gris para modelos
    }
  }

  cp_cotizacion_model = component 'Cotizacion Model' {
    technology 'Mongoose Schema'
    description 'Modelo de datos para cotizaciones'

    style {
      color slate  // Gris para modelos
    }
  }

  cp_orden_compra_model = component 'OrdenCompra Model' {
    technology 'Mongoose Schema'
    description 'Modelo de datos para Ã³rdenes de compra'

    style {
      color slate  // Gris para modelos
    }
  }

  cp_proveedor_model = component 'Proveedor Model' {
    technology 'Mongoose Schema'
    description 'Modelo de datos para proveedores'

    style {
      color slate  // Gris para modelos
    }
  }

  cp_solicitud_compra_model = component 'SolicitudCompra Model' {
    technology 'Mongoose Schema'
    description 'Modelo de datos para solicitudes de compra'

    style {
      color slate  // Gris para modelos
    }
  }

  cp_comprobante_orden_compra_model = component 'ComprobanteOrdenCompra Model' {
    technology 'Mongoose Schema'
    description 'Modelo de datos para comprobantes de Ã³rdenes de compra'

    style {
      color slate  // Gris para modelos
    }
  }

  cp_guia_remision_model = component 'GuiaRemision Model' {
    technology 'Mongoose Schema'
    description 'Modelo de datos para guÃ­as de remisiÃ³n'

    style {
      color slate  // Gris para modelos
    }
  }

  // ===== âš« SERVICIOS ESPECIALIZADOS =====
  cp_solicitud_compra_service = application 'SolicitudCompraService' {
    description 'GestiÃ³n de solicitudes de compra'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_comprobante_orden_compra_service = application 'ComprobanteOrdenCompraService' {
    description 'Servicio para gestiÃ³n de comprobantes de Ã³rdenes de compra'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_guia_remision_service = application 'GuiaRemisionService' {
    description 'Servicio para gestiÃ³n de guÃ­as de remisiÃ³n'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_aprobacion_cierre_orden_compra_service = application 'AprobacionCierreOrdencompraService' {
    description 'Servicio para aprobaciones de cierre de Ã³rdenes'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_incumplimiento_orden_compra_service = application 'IncumplimientoOrdenCompraRecursoService' {
    description 'Servicio para gestiÃ³n de incumplimientos en Ã³rdenes'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_pago_compra_comprobante_service = application 'PagoCompraComprobanteService' {
    description 'Servicio para gestiÃ³n de pagos de compras'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  // ===== ðŸ”„ SERVICIOS DE RECURSOS =====
  cp_compra_recurso_service = application 'CompraRecursoService' {
    description 'GestiÃ³n de recursos en compras'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_orden_compra_recurso_service = application 'OrdenCompraRecursoService' {
    description 'Recursos asociados a Ã³rdenes de compra'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_cotizacion_recurso_service = application 'CotizacionRecursoService' {
    description 'Recursos en cotizaciones'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_solicitud_compra_recurso_service = application 'SolicitudCompraRecursoService' {
    description 'Recursos en solicitudes de compra'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_seguimiento_cotizacion_recurso_service = application 'SeguimientoCotizacionRecursoService' {
    description 'Seguimiento de recursos en cotizaciones'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  // ===== ðŸ”„ SERVICIOS DE PROCESAMIENTO =====
  cp_email_service = application 'EmailService' {
    description 'Servicio de envÃ­o de correos electrÃ³nicos para compras'
    technology 'NodeMailer + Gmail API'
  }

  cp_notificacion_cotizacion_service = application 'NotificacionCotizacionService' {
    description 'Servicio de notificaciones para cotizaciones'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  cp_notificacion_orden_compra_service = application 'NotificacionOrdenCompraService' {
    description 'Servicio de notificaciones para Ã³rdenes de compra'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  // ===== SERVICIOS DE DOCUMENTOS =====
  cp_documento_cotizacion_service = application 'DocumentoCotizacionService' {
    description 'GestiÃ³n documental de cotizaciones'
    technology 'TypeScript + Node.js'

    style {
      color green  // Verde para servicios
    }
  }

  // ===== âš« INFRAESTRUCTURA =====
  cp_mongodb = database 'MongoDB' {
    description 'Base de datos principal MongoDB'
    icon tech:mongodb
  }

  cp_redis = database 'Redis' {
    description 'Sistema de cache Redis'
    icon tech:redis
  }

  cp_queue_service = queue 'Queue Service' {
    description 'Sistema de colas para procesamiento asÃ­ncrono'
  }

  // ===== ðŸ”„ RELACIONES REALES =====

  // API â†’ Resolvers
  cp_graphql_api -> cp_compra_resolver 'Procesa queries/mutations'
  cp_graphql_api -> cp_cotizacion_resolver 'Procesa queries/mutations'
  cp_graphql_api -> cp_orden_compra_resolver 'Procesa queries/mutations'
  cp_graphql_api -> cp_proveedor_resolver 'Procesa queries/mutations'
  cp_graphql_api -> cp_solicitud_compra_resolver 'Procesa queries/mutations'

  // Resolvers â†’ Servicios Principales
  cp_compra_resolver -> cp_compra_service 'Delega operaciones'
  cp_cotizacion_resolver -> cp_cotizacion_service 'Delega operaciones'
  cp_orden_compra_resolver -> cp_orden_compra_service 'Delega operaciones'
  cp_proveedor_resolver -> cp_proveedor_service 'Delega operaciones'
  cp_solicitud_compra_resolver -> cp_solicitud_compra_service 'Delega operaciones'

  // Servicios Principales â†’ Modelos
  cp_compra_service -> cp_compra_model 'Persiste datos'
  cp_cotizacion_service -> cp_cotizacion_model 'Persiste datos'
  cp_orden_compra_service -> cp_orden_compra_model 'Persiste datos'
  cp_proveedor_service -> cp_proveedor_model 'Persiste datos'
  cp_solicitud_compra_service -> cp_solicitud_compra_model 'Persiste datos'

  // Servicios Especializados â†’ Modelos
  cp_comprobante_orden_compra_service -> cp_comprobante_orden_compra_model 'Persiste datos'
  cp_guia_remision_service -> cp_guia_remision_model 'Persiste datos'

  // Servicios colaboran entre sÃ­ (Flujo de Compras)
  cp_compra_service -> cp_cotizacion_service 'Inicia cotizaciÃ³n'
  cp_compra_service -> cp_orden_compra_service 'Genera Ã³rdenes de compra'
  cp_compra_service -> cp_solicitud_compra_service 'Crea solicitudes'

  cp_cotizacion_service -> cp_proveedor_service 'Valida proveedores'
  cp_cotizacion_service -> cp_cotizacion_recurso_service 'Gestiona recursos'
  cp_cotizacion_service -> cp_seguimiento_cotizacion_recurso_service 'Seguimiento recursos'
  cp_cotizacion_service -> cp_documento_cotizacion_service 'Documentos'
  cp_cotizacion_service -> cp_notificacion_cotizacion_service 'EnvÃ­a notificaciones'

  cp_orden_compra_service -> cp_orden_compra_recurso_service 'Gestiona recursos'
  cp_orden_compra_service -> cp_comprobante_orden_compra_service 'Genera comprobantes'
  cp_orden_compra_service -> cp_guia_remision_service 'Gestiona guÃ­as'
  cp_orden_compra_service -> cp_aprobacion_cierre_orden_compra_service 'Aprobaciones'
  cp_orden_compra_service -> cp_incumplimiento_orden_compra_service 'Incumplimientos'
  cp_orden_compra_service -> cp_pago_compra_comprobante_service 'Procesamiento pagos'
  cp_orden_compra_service -> cp_notificacion_orden_compra_service 'EnvÃ­a notificaciones'

  cp_procesador_compra_completa_service -> cp_compra_service 'Orquesta flujo completo'
  cp_procesador_compra_completa_service -> cp_cotizacion_service 'Orquesta cotizaciones'
  cp_procesador_compra_completa_service -> cp_orden_compra_service 'Orquesta Ã³rdenes'

  // Servicios de Recursos
  cp_compra_recurso_service -> cp_compra_model 'Relaciona recursos'
  cp_cotizacion_recurso_service -> cp_cotizacion_model 'Relaciona recursos'
  cp_orden_compra_recurso_service -> cp_orden_compra_model 'Relaciona recursos'
  cp_solicitud_compra_recurso_service -> cp_solicitud_compra_model 'Relaciona recursos'

  // Servicios â†’ Infraestructura
  cp_compra_service -> cp_mongodb 'Accede a base de datos'
  cp_cotizacion_service -> cp_mongodb 'Accede a base de datos'
  cp_orden_compra_service -> cp_mongodb 'Accede a base de datos'
  cp_proveedor_service -> cp_mongodb 'Accede a base de datos'

  cp_compra_service -> cp_redis 'Usa cache'
  cp_cotizacion_service -> cp_redis 'Usa cache'
  cp_orden_compra_service -> cp_redis 'Usa cache'

  // Servicios de Notificaciones â†’ Queue
  cp_notificacion_cotizacion_service -> cp_queue_service 'EnvÃ­a emails async'
  cp_notificacion_orden_compra_service -> cp_queue_service 'EnvÃ­a emails async'
  cp_email_service -> cp_queue_service 'Procesa emails async'
}
